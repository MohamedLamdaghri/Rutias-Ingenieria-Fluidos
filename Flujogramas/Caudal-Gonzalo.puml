
@startuml Caudal_activity
skinparam backgroundColor white
skinparam activity {
  BackgroundColor<<io>> #E8F5E9
  BackgroundColor<<calc>> #E7F3FF
  BackgroundColor<<decision>> #FFF3E0
  BorderColor #444
}

start
:'GUI': Leer entradas\nD, L, k, ν, Hf; <<io>>

partition "Inicialización" {
  :f = 0.02; <<calc>>
  :Q = q_from_hf(f, D, L, Hf); <<calc>>
  :Re_est = reynolds(Q, D, ν); <<calc>>
  :f = swamee_jain_f(Re_est, k, D); <<calc>>
}

repeat
  :V = Q / area(D); <<calc>>
  :Re = reynolds(Q, D, ν); <<calc>>
  :f = colebrook(Re, k, D, f); <<calc>>
  :Q_new = q_from_hf(f, D, L, Hf); <<calc>>
  :err = |Q_new - Q| / Q_new; <<calc>>
  :Q = Q_new; <<calc>>
repeat while (err < tol?) is (No)

:V = Q / area(D); <<calc>>
:Re = reynolds(Q, D, ν); <<calc>>
if (Re < 2000?) then (Sí)
  :regimen = "Laminar"; <<calc>>
elseif (Re < 4000?) then (Sí)
  :regimen = "Transitorio"; <<calc>>
else (No)
  :regimen = "Turbulento"; <<calc>>
endif

:'GUI': Mostrar resultados\nQ, V, Re, f, regimen, iteraciones, converge; <<io>>
stop
@enduml
